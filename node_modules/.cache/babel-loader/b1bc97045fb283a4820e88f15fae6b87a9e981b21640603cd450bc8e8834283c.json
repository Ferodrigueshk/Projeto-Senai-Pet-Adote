{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { db } from \"../firebase/config\";\nimport { collection, query, orderBy, onSnapshot, where, QuerySnapshot } from \"firebase/firestore\";\nexport const useFetchDocuments = (docCollection, search = null, uid = null) => {\n  _s();\n  const [documents, setDocuments] = useState(null);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(null);\n  const [cancelled, setCancelled] = useState(false);\n  useEffect(() => {\n    async function loadData() {\n      if (cancelled) return;\n      setLoading(true);\n      const collectionRef = await collection(db, docCollection);\n      try {\n        let q;\n        if (search) {\n          q = await query(collectionRef, where(\"tagsArray\", \"array-contains\", search), orderBy(\"createdAt\", \"desc\"));\n        } else if (uid) {\n          q = await query(collectionRef, where(\"uid\", \"==\", uid), orderBy(\"createdAt\", \"desc\"));\n        } else {\n          q = await query(collectionRef, orderBy(\"createdAt\", \"desc\"));\n        }\n        await onSnapshot(q, QuerySnapshot => {\n          setDocuments(QuerySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n          })));\n        });\n        setLoading(false);\n      } catch (error) {\n        console.log(error);\n        setError(error.message);\n      }\n    }\n    loadData();\n  }, [docCollection, search, uid, cancelled]);\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n  return {\n    documents,\n    loading,\n    error\n  };\n};\n_s(useFetchDocuments, \"oHQtMVeLQvU17FI2wc7iUGDhIAM=\");","map":{"version":3,"names":["useState","useEffect","db","collection","query","orderBy","onSnapshot","where","QuerySnapshot","useFetchDocuments","docCollection","search","uid","_s","documents","setDocuments","error","setError","loading","setLoading","cancelled","setCancelled","loadData","collectionRef","q","docs","map","doc","id","data","console","log","message"],"sources":["/home/rafa/MINIBLOG/src/hooks/useFetchDocuments.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { db } from \"../firebase/config\";\nimport {\n  collection,\n  query,\n  orderBy,\n  onSnapshot,\n  where,\n  QuerySnapshot,\n} from \"firebase/firestore\";\n\nexport const useFetchDocuments = (docCollection, search = null, uid = null) => {\n  const [documents, setDocuments] = useState(null);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(null);\n\n  const [cancelled, setCancelled] = useState(false);\n\n  useEffect(() => {\n    async function loadData() {\n      if (cancelled) return;\n\n      setLoading(true);\n\n      const collectionRef = await collection(db, docCollection);\n\n      try {\n        let q;\n\n        if (search) {\n          q = await query(\n            collectionRef,\n            where(\"tagsArray\", \"array-contains\", search),\n            orderBy(\"createdAt\", \"desc\")\n          );\n        }else if(uid){\n            q = await query(\n            collectionRef,\n            where(\"uid\", \"==\", uid),\n            orderBy(\"createdAt\", \"desc\")\n          );\n        } else {\n          q = await query(collectionRef, orderBy(\"createdAt\", \"desc\"));\n        }\n\n        await onSnapshot(q, (QuerySnapshot) => {\n          setDocuments(\n            QuerySnapshot.docs.map((doc) => ({\n              id: doc.id,\n              ...doc.data(),\n            }))\n          );\n        });\n        setLoading(false);\n      } catch (error) {\n        console.log(error);\n        setError(error.message);\n      }\n    }\n    loadData();\n  }, [docCollection, search, uid, cancelled]);\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n  return { documents, loading, error };\n};\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,EAAE,QAAQ,oBAAoB;AACvC,SACEC,UAAU,EACVC,KAAK,EACLC,OAAO,EACPC,UAAU,EACVC,KAAK,EACLC,aAAa,QACR,oBAAoB;AAE3B,OAAO,MAAMC,iBAAiB,GAAGA,CAACC,aAAa,EAAEC,MAAM,GAAG,IAAI,EAAEC,GAAG,GAAG,IAAI,KAAK;EAAAC,EAAA;EAC7E,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACgB,KAAK,EAAEC,QAAQ,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACkB,OAAO,EAAEC,UAAU,CAAC,GAAGnB,QAAQ,CAAC,IAAI,CAAC;EAE5C,MAAM,CAACoB,SAAS,EAAEC,YAAY,CAAC,GAAGrB,QAAQ,CAAC,KAAK,CAAC;EAEjDC,SAAS,CAAC,MAAM;IACd,eAAeqB,QAAQA,CAAA,EAAG;MACxB,IAAIF,SAAS,EAAE;MAEfD,UAAU,CAAC,IAAI,CAAC;MAEhB,MAAMI,aAAa,GAAG,MAAMpB,UAAU,CAACD,EAAE,EAAEQ,aAAa,CAAC;MAEzD,IAAI;QACF,IAAIc,CAAC;QAEL,IAAIb,MAAM,EAAE;UACVa,CAAC,GAAG,MAAMpB,KAAK,CACbmB,aAAa,EACbhB,KAAK,CAAC,WAAW,EAAE,gBAAgB,EAAEI,MAAM,CAAC,EAC5CN,OAAO,CAAC,WAAW,EAAE,MAAM,CAC7B,CAAC;QACH,CAAC,MAAK,IAAGO,GAAG,EAAC;UACTY,CAAC,GAAG,MAAMpB,KAAK,CACfmB,aAAa,EACbhB,KAAK,CAAC,KAAK,EAAE,IAAI,EAAEK,GAAG,CAAC,EACvBP,OAAO,CAAC,WAAW,EAAE,MAAM,CAC7B,CAAC;QACH,CAAC,MAAM;UACLmB,CAAC,GAAG,MAAMpB,KAAK,CAACmB,aAAa,EAAElB,OAAO,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;QAC9D;QAEA,MAAMC,UAAU,CAACkB,CAAC,EAAGhB,aAAa,IAAK;UACrCO,YAAY,CACVP,aAAa,CAACiB,IAAI,CAACC,GAAG,CAAEC,GAAG,KAAM;YAC/BC,EAAE,EAAED,GAAG,CAACC,EAAE;YACV,GAAGD,GAAG,CAACE,IAAI,CAAC;UACd,CAAC,CAAC,CACJ,CAAC;QACH,CAAC,CAAC;QACFV,UAAU,CAAC,KAAK,CAAC;MACnB,CAAC,CAAC,OAAOH,KAAK,EAAE;QACdc,OAAO,CAACC,GAAG,CAACf,KAAK,CAAC;QAClBC,QAAQ,CAACD,KAAK,CAACgB,OAAO,CAAC;MACzB;IACF;IACAV,QAAQ,CAAC,CAAC;EACZ,CAAC,EAAE,CAACZ,aAAa,EAAEC,MAAM,EAAEC,GAAG,EAAEQ,SAAS,CAAC,CAAC;EAC3CnB,SAAS,CAAC,MAAM;IACd,OAAO,MAAMoB,YAAY,CAAC,IAAI,CAAC;EACjC,CAAC,EAAE,EAAE,CAAC;EACN,OAAO;IAAEP,SAAS;IAAEI,OAAO;IAAEF;EAAM,CAAC;AACtC,CAAC;AAACH,EAAA,CAtDWJ,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"var _s = $RefreshSig$();\nimport { db } from \"../firebase/config\";\nimport { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile, signOut } from \"firebase/auth\";\nimport { useState, useEffect } from \"react\";\nexport const useAuthentication = () => {\n  _s();\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(null);\n\n  // deal with memory leak\n  const [cancelled, setCancelled] = useState(false);\n  const auth = getAuth();\n  function checkIfIsCancelled() {\n    if (cancelled) {\n      return;\n    }\n  }\n  const createUser = async data => {\n    checkIfIsCancelled();\n    setLoading(true);\n    setError(null);\n    try {\n      // 1. Cria usuário no Auth\n      const {\n        user\n      } = await createUserWithEmailAndPassword(auth, data.email, data.password);\n\n      // 2. Atualiza nome no Auth\n      await updateProfile(user, {\n        displayName: data.displayName\n      });\n\n      // 3. Salva dados extras no Firestore\n      await setDoc(doc(db, \"users\", user.uid), {\n        displayName: data.displayName,\n        email: data.email,\n        telefone: data.telefone,\n        endereco: data.endereco,\n        createdAt: new Date()\n      });\n      setLoading(false);\n      return user;\n    } catch (error) {\n      console.log(error.message);\n      let systemErrorMessage;\n      if (error.message.includes(\"Password\")) {\n        systemErrorMessage = \"A senha precisa conter pelo menos 6 caracteres.\";\n      } else if (error.message.includes(\"email-already\")) {\n        systemErrorMessage = \"E-mail já cadastrado.\";\n      } else {\n        systemErrorMessage = \"Ocorreu um erro, por favor tente mais tarde.\";\n      }\n      setLoading(false);\n      setError(systemErrorMessage);\n    }\n  };\n  const login = async data => {\n    checkIfIsCancelled();\n    setLoading(true);\n    setError(true);\n    try {\n      await signInWithEmailAndPassword(auth, data.email, data.password);\n    } catch (error) {\n      console.log(error.message);\n      console.log(typeof error.message);\n      console.log(error.message.includes(\"user-not\"));\n      let systemErrorMessage;\n      if (error.message.includes(\"user-not-found\")) {\n        systemErrorMessage = \"Usuário não encontrado.\";\n      } else if (error.message.includes(\"wrong-password\")) {\n        systemErrorMessage = \"Senha incorreta.\";\n      } else {\n        systemErrorMessage = \"Ocorreu um erro, por favor tenta mais tarde.\";\n      }\n      console.log(systemErrorMessage);\n      setError(systemErrorMessage);\n    }\n    console.log(error);\n    setLoading(false);\n  };\n  const logout = () => {\n    checkIfIsCancelled();\n    signOut(auth);\n  };\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n  return {\n    auth,\n    createUser,\n    error,\n    logout,\n    login,\n    loading\n  };\n};\n_s(useAuthentication, \"xO6KHeiqqCsOzooKHe/mUZTZLjs=\");","map":{"version":3,"names":["db","getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","updateProfile","signOut","useState","useEffect","useAuthentication","_s","error","setError","loading","setLoading","cancelled","setCancelled","auth","checkIfIsCancelled","createUser","data","user","email","password","displayName","setDoc","doc","uid","telefone","endereco","createdAt","Date","console","log","message","systemErrorMessage","includes","login","logout"],"sources":["/home/rafa/MINIBLOG/src/hooks/useAuthentication.js"],"sourcesContent":["import { db } from \"../firebase/config\";\nimport {\n  getAuth,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  updateProfile,\n  signOut,\n} from \"firebase/auth\";\n\nimport { useState, useEffect } from \"react\";\n\nexport const useAuthentication = () => {\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(null);\n\n  // deal with memory leak\n  const [cancelled, setCancelled] = useState(false);\n\n  const auth = getAuth();\n\n  function checkIfIsCancelled() {\n    if (cancelled) {\n      return;\n    }\n  }\n\n  const createUser = async (data) => {\n  checkIfIsCancelled();\n  setLoading(true);\n  setError(null);\n\n  try {\n    // 1. Cria usuário no Auth\n    const { user } = await createUserWithEmailAndPassword(\n      auth,\n      data.email,\n      data.password\n    );\n\n    // 2. Atualiza nome no Auth\n    await updateProfile(user, {\n      displayName: data.displayName,\n    });\n\n    // 3. Salva dados extras no Firestore\n    await setDoc(doc(db, \"users\", user.uid), {\n      displayName: data.displayName,\n      email: data.email,\n      telefone: data.telefone,\n      endereco: data.endereco,\n      createdAt: new Date(),\n    });\n\n    setLoading(false);\n    return user;\n\n  } catch (error) {\n    console.log(error.message);\n\n    let systemErrorMessage;\n\n    if (error.message.includes(\"Password\")) {\n      systemErrorMessage = \"A senha precisa conter pelo menos 6 caracteres.\";\n    } else if (error.message.includes(\"email-already\")) {\n      systemErrorMessage = \"E-mail já cadastrado.\";\n    } else {\n      systemErrorMessage = \"Ocorreu um erro, por favor tente mais tarde.\";\n    }\n\n      setLoading(false);\n      setError(systemErrorMessage);\n    }\n  };\n\n  const login = async (data) => {\n    checkIfIsCancelled();\n\n    \n    setLoading(true);\n    setError(true);\n\n    try {\n      await signInWithEmailAndPassword(auth, data.email, data.password);\n    } catch (error) {\n      console.log(error.message);\n      console.log(typeof error.message);\n      console.log(error.message.includes(\"user-not\"));\n\n      let systemErrorMessage;\n\n      if (error.message.includes(\"user-not-found\")) {\n        systemErrorMessage = \"Usuário não encontrado.\";\n      } else if (error.message.includes(\"wrong-password\")) {\n        systemErrorMessage = \"Senha incorreta.\";\n      } else {\n        systemErrorMessage = \"Ocorreu um erro, por favor tenta mais tarde.\";\n      }\n\n      console.log(systemErrorMessage);\n\n      setError(systemErrorMessage);\n    }\n\n    console.log(error);\n\n    setLoading(false);\n  };\n\n  const logout = () => {\n    checkIfIsCancelled();\n\n    signOut(auth);\n  };\n\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n\n  return {\n    auth,\n    createUser,\n    error,\n    logout,\n    login,\n    loading,\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
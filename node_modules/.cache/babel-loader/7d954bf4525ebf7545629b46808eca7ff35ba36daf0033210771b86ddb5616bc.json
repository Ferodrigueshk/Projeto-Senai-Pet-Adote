{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { db } from \"../firebase/config\";\nimport { collection, query, orderBy, onSnapshot, where } from \"firebase/firestore\";\nexport const useFetchDocuments = (docCollection, search = null, uid = null) => {\n  _s();\n  const [documents, setDocuments] = useState([]);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [cancelled, setCancelled] = useState(false);\n  useEffect(() => {\n    if (cancelled) return;\n    setLoading(true);\n    const collectionRef = collection(db, docCollection);\n    let q;\n    try {\n      if (search) {\n        q = query(collectionRef, where(\"tagsArray\", \"array-contains\", search), orderBy(\"createdAt\", \"desc\"));\n      } else if (uid) {\n        q = query(collectionRef, where(\"uid\", \"==\", uid), orderBy(\"createdAt\", \"desc\"));\n      } else {\n        q = query(collectionRef, orderBy(\"createdAt\", \"desc\"));\n      }\n      const unsubscribe = onSnapshot(q, snapshot => {\n        if (!cancelled) {\n          setDocuments(snapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n          })));\n          setLoading(false);\n        }\n      }, err => {\n        console.log(err);\n        if (!cancelled) {\n          setError(\"Erro ao buscar documentos.\");\n          setLoading(false);\n        }\n      });\n      return () => unsubscribe();\n    } catch (err) {\n      console.log(err);\n      if (!cancelled) setError(err.message);\n    }\n  }, [docCollection, search, uid, cancelled]);\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n  return {\n    documents,\n    loading,\n    error\n  };\n};\n_s(useFetchDocuments, \"3p0vdNJ4F+8seZvSoJbRkMkmMew=\");","map":{"version":3,"names":["useState","useEffect","db","collection","query","orderBy","onSnapshot","where","useFetchDocuments","docCollection","search","uid","_s","documents","setDocuments","error","setError","loading","setLoading","cancelled","setCancelled","collectionRef","q","unsubscribe","snapshot","docs","map","doc","id","data","err","console","log","message"],"sources":["/home/rafa/MINIBLOG/src/hooks/useFetchDocuments.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { db } from \"../firebase/config\";\nimport { collection, query, orderBy, onSnapshot, where } from \"firebase/firestore\";\n\nexport const useFetchDocuments = (docCollection, search = null, uid = null) => {\n  const [documents, setDocuments] = useState([]);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [cancelled, setCancelled] = useState(false);\n\n  useEffect(() => {\n    if (cancelled) return;\n\n    setLoading(true);\n\n    const collectionRef = collection(db, docCollection);\n    let q;\n\n    try {\n      if (search) {\n        q = query(\n          collectionRef,\n          where(\"tagsArray\", \"array-contains\", search),\n          orderBy(\"createdAt\", \"desc\")\n        );\n      } else if (uid) {\n        q = query(\n          collectionRef,\n          where(\"uid\", \"==\", uid),\n          orderBy(\"createdAt\", \"desc\")\n        );\n      } else {\n        q = query(collectionRef, orderBy(\"createdAt\", \"desc\"));\n      }\n\n      const unsubscribe = onSnapshot(\n        q,\n        (snapshot) => {\n          if (!cancelled) {\n            setDocuments(snapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() })));\n            setLoading(false);\n          }\n        },\n        (err) => {\n          console.log(err);\n          if (!cancelled) {\n            setError(\"Erro ao buscar documentos.\");\n            setLoading(false);\n          }\n        }\n      );\n\n      return () => unsubscribe();\n    } catch (err) {\n      console.log(err);\n      if (!cancelled) setError(err.message);\n    }\n  }, [docCollection, search, uid, cancelled]);\n\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n\n  return { documents, loading, error };\n};\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,EAAE,QAAQ,oBAAoB;AACvC,SAASC,UAAU,EAAEC,KAAK,EAAEC,OAAO,EAAEC,UAAU,EAAEC,KAAK,QAAQ,oBAAoB;AAElF,OAAO,MAAMC,iBAAiB,GAAGA,CAACC,aAAa,EAAEC,MAAM,GAAG,IAAI,EAAEC,GAAG,GAAG,IAAI,KAAK;EAAAC,EAAA;EAC7E,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACe,KAAK,EAAEC,QAAQ,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACiB,OAAO,EAAEC,UAAU,CAAC,GAAGlB,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACmB,SAAS,EAAEC,YAAY,CAAC,GAAGpB,QAAQ,CAAC,KAAK,CAAC;EAEjDC,SAAS,CAAC,MAAM;IACd,IAAIkB,SAAS,EAAE;IAEfD,UAAU,CAAC,IAAI,CAAC;IAEhB,MAAMG,aAAa,GAAGlB,UAAU,CAACD,EAAE,EAAEO,aAAa,CAAC;IACnD,IAAIa,CAAC;IAEL,IAAI;MACF,IAAIZ,MAAM,EAAE;QACVY,CAAC,GAAGlB,KAAK,CACPiB,aAAa,EACbd,KAAK,CAAC,WAAW,EAAE,gBAAgB,EAAEG,MAAM,CAAC,EAC5CL,OAAO,CAAC,WAAW,EAAE,MAAM,CAC7B,CAAC;MACH,CAAC,MAAM,IAAIM,GAAG,EAAE;QACdW,CAAC,GAAGlB,KAAK,CACPiB,aAAa,EACbd,KAAK,CAAC,KAAK,EAAE,IAAI,EAAEI,GAAG,CAAC,EACvBN,OAAO,CAAC,WAAW,EAAE,MAAM,CAC7B,CAAC;MACH,CAAC,MAAM;QACLiB,CAAC,GAAGlB,KAAK,CAACiB,aAAa,EAAEhB,OAAO,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;MACxD;MAEA,MAAMkB,WAAW,GAAGjB,UAAU,CAC5BgB,CAAC,EACAE,QAAQ,IAAK;QACZ,IAAI,CAACL,SAAS,EAAE;UACdL,YAAY,CAACU,QAAQ,CAACC,IAAI,CAACC,GAAG,CAAEC,GAAG,KAAM;YAAEC,EAAE,EAAED,GAAG,CAACC,EAAE;YAAE,GAAGD,GAAG,CAACE,IAAI,CAAC;UAAE,CAAC,CAAC,CAAC,CAAC;UACzEX,UAAU,CAAC,KAAK,CAAC;QACnB;MACF,CAAC,EACAY,GAAG,IAAK;QACPC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;QAChB,IAAI,CAACX,SAAS,EAAE;UACdH,QAAQ,CAAC,4BAA4B,CAAC;UACtCE,UAAU,CAAC,KAAK,CAAC;QACnB;MACF,CACF,CAAC;MAED,OAAO,MAAMK,WAAW,CAAC,CAAC;IAC5B,CAAC,CAAC,OAAOO,GAAG,EAAE;MACZC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;MAChB,IAAI,CAACX,SAAS,EAAEH,QAAQ,CAACc,GAAG,CAACG,OAAO,CAAC;IACvC;EACF,CAAC,EAAE,CAACxB,aAAa,EAAEC,MAAM,EAAEC,GAAG,EAAEQ,SAAS,CAAC,CAAC;EAE3ClB,SAAS,CAAC,MAAM;IACd,OAAO,MAAMmB,YAAY,CAAC,IAAI,CAAC;EACjC,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IAAEP,SAAS;IAAEI,OAAO;IAAEF;EAAM,CAAC;AACtC,CAAC;AAACH,EAAA,CA5DWJ,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}